<?xml version="1.0" encoding="utf-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2003/01/wi">
  <Product UpgradeCode="2E280DED-3E0E-4783-94A9-BE102C854C39" Name="NUnit $(var.NominalVersion)" 
  		   Id="1AA69CCD-1078-473A-BD6E-11CE30A81C58" Version="$(var.ProductVersion)" 
		   Manufacturer="nunit.org" Language="1033">
  
    <Package Id="????????-????-????-????-????????????" Comments="NUnit $(var.ProductVersion)" 
			 Manufacturer="nunit.org" InstallerVersion="200" Platforms="Intel" 
			 Languages="1033" Compressed="yes" SummaryCodepage="1252" />
			 
    <Property Id="FRAMEWORK10">
      <RegistrySearch Id='Framework10Registry' Type='raw'
        Root='HKLM' Key='Software\Microsoft\.NETFramework\policy\v1.0' Name='3705' />
    </Property>

    <Property Id="FRAMEWORK11">
      <RegistrySearch Id='Framework11Registry' Type='raw'
        Root='HKLM' Key='Software\Microsoft\.NETFramework\policy\v1.1' Name='4322' />
    </Property>

    <Property Id="FRAMEWORK20">
      <RegistrySearch Id='Framework20Registry' Type='raw'
        Root='HKLM' Key='Software\Microsoft\.NETFramework\policy\v2.0' Name='50727' />
    </Property>
	
	<Property Id="MONODEFAULTCLR">
	  <RegistrySearch Id="MonoDefaultClr" Type='raw'
	    Root='HKLM' Key='Software\Novell\Mono' Name='DefaultCLR' />
	</Property>
	
	<Property Id="MONODIRECTORY">
	  <RegistrySearch Id="MonoDirectory" Type='directory'
	    Root='HKLM' Key='Software\Novell\Mono\[MONODEFAULTCLR]' Name='SDKInstallRoot' />
	</Property>

    <!-- Define all directories used in the install -->
	<Directory Id="TARGETDIR" Name="SourceDir">
	  <Directory Id='ProgramFilesFolder' Name='PFiles'>
		
		<!-- Target locations for NUnit Files -->
		<Directory Id='INSTALLDIR' Name='NUnit' LongName="NUnit $(var.NominalVersion)"> 
		  <Directory Id='Assemblies' Name='AF' LongName='Assemblies' /> 
		  <Directory Id='bin' Name='bin' />
		  <Directory Id='doc' Name='doc'>
		    <Directory Id='files' />
			<Directory Id='img' />
		  </Directory>
		  <Directory Id='samples' Name='samples'>
			<Directory Id='csharp' Name='csharp' />
			<Directory Id='jsharp' Name='jsharp' />
			<Directory Id='vb' Name='vb' />
			<Directory Id='cpp' Name='cpp' />
			<Directory Id='extensibility' Name='EXTENSIB' LongName='Extensibility' />
		  </Directory>		
		</Directory>
		
	  </Directory>

      <!-- Desktop Folder Directory for our Desktop Shortcut -->
	  <Directory Id="DesktopFolder" Name="." SourceName="DESKTOP" LongSource="User's Desktop" />
      
      <!-- Program Menu Folder and our subfolders for Shortcuts -->
	  <Directory Id="ProgramMenuFolder" Name="." SourceName="PROGRAMS" LongSource="User's Program Menu">
        <Directory Id="NUnitMenu" Name="NUnit" LongName="NUnit $(var.NominalVersion)" >
		  <Directory Id="SamplesMenu" Name="Samples" />
		</Directory>
      </Directory>
      
    </Directory>
    
	<!-- Top Level File Components -->
	<DirectoryRef Id="INSTALLDIR">
	
      <Component Id="C__LOGO" Guid="99080421-75CC-4DFC-0987-AA16B7E68659">
        <File Id="_LOGO" Name="Logo.ico" Source="Logo.ico" Vital="yes" KeyPath="yes" DiskId="1" />
		<RemoveFile Id="RF_thumbs.db" Name="thumbs.db" On="uninstall" />
      </Component>
      
      <Component Id="C__LICENSE" Guid="7D03AE6B-15A7-16E0-0D21-D65708B2FA79">
        <File Id="_LICENSE" Name="license.rtf" Source="license.rtf" 
			  Vital="yes" KeyPath="yes" DiskId="1" />
      </Component>
	  
	</DirectoryRef>
      
	<!-- A copy of the assemblies referenced by tests are installed in a
		 separate folder that is made known to Visual Studio so that
		 references may be added more easily -->
	<DirectoryRef Id="Assemblies" FileSource="bin">
	
		<Component Id="C__AssemblyFolders" DiskId="1" Guid="F9B1325D-286F-6638-4AD2-AC8F3509BC4F">
		    <File Id="nunit.framework.copy" Name="FRAMEWRK.CPY" LongName="nunit.framework.dll" />
			<File Id="nunit.framework.extensions.copy" Name="FRAME_EX.CPY" 
			   LongName="nunit.framework.extensions.dll" />
		</Component>
			
	</DirectoryRef>
	
    <!-- Define the NUnit base feature it's contents and reference 
		 sub-features defined in other files -->
	<Feature Id="BaseFeature" Level="1" ConfigurableDirectory="INSTALLDIR"
		Title='NUnit 2.4' Display='expand'
		Description="Base NUnit assemblies required to write and run tests using the NUnit-Console runner.">
      
        <!-- Defined above -->
		<ComponentRef Id="C__LICENSE" />
        <ComponentRef Id="C__LOGO" />
		<ComponentRef Id="C__AssemblyFolders" />

		<!-- Defined in bin.wxs -->
		<ComponentRef Id="C__NUnitBase" />
		<ComponentRef Id="C__NUnitRegistry" />
		<FeatureRef Id="GuiFeature" />
		
		<!-- Defined in doc.wxs -->
		<FeatureRef Id="DocFeature" />
		
		<!-- Defined in samples.wxs -->
		<FeatureRef Id="SamplesFeature" />
		
		<!-- Defined in tests.wxs -->
		<FeatureRef Id="TestsFeature" />
		     
    </Feature>
   
	<!-- The NUnit files are all in a single cab file that is embedded in the MSI -->
	<Media Id="1" EmbedCab="yes" Cabinet="nunit.cab" />

	<!-- Define our GUI using the standard WiX UI FeatureTree set-->
	<UIRef Id="WixUI_FeatureTree" />
    <UIRef Id="WixUI_ErrorProgressText" /> 
	
  </Product>
</Wix>