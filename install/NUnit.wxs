<?xml version="1.0" encoding="utf-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2003/01/wi">

  <Product 
           UpgradeCode="009074FF-2CEC-4b0c-9951-B07186F9ED3A"
           Name="NUnit $(var.NominalVersion)"
	   Id="321FC471-2945-4d25-8D04-10B6A7AE5F15"
           Version="$(var.ProductVersion)"
           Manufacturer="nunit.org"
           Language="1033">

    <Package Id="????????-????-????-????-????????????"
             Comments="NUnit $(var.ProductVersion)"
		         Manufacturer="nunit.org"
             InstallerVersion="200"
             Platforms="Intel"
		         Languages="1033"
             Compressed="yes"
             SummaryCodepage="1252" />

    <!-- ***************************************************************** -->
    <!-- **********  Define Properties used in the install      ********** -->
    <!-- ***************************************************************** -->

    <Property Id="FRAMEWORK20">
      <RegistrySearch Id='Framework20Registry' Type='raw' Root='HKLM'
                      Key='Software\Microsoft\.NETFramework\policy\v2.0' Name='50727' />
    </Property>

    <Property Id="MONODEFAULTCLR">
      <RegistrySearch Id="MonoDefaultClr" Type='raw' Root='HKLM'
                      Key='Software\Novell\Mono' Name='DefaultCLR' />
    </Property>

    <Property Id="MONODIRECTORY">
      <RegistrySearch Id="MonoDirectory" Type='directory' Root='HKLM'
                      Key='Software\Novell\Mono\[MONODEFAULTCLR]' Name='SDKInstallRoot' />
    </Property>

    <Property Id="CMD_EXE" Value="[!SystemFolder]cmd.exe"/>

    <!-- ***************************************************************** -->
    <!-- *********  Properties for the Add Remove Programs list  ********* -->
    <!-- ***************************************************************** -->

    <Property Id="ARPCONTACT" Value="Charlie Poole" />
    <Property Id='ARPPRODUCTICON' Value='nunit_icon.exe'/>
    <Property Id="ARPHELPLINK" Value="http://lists.sourceforge.net/lists/listinfo/nunit-users" />
    <Property Id="ARPREADME" Value="http://nunit.org/?p=releaseNotes&amp;r=2.5" />
    <Property Id="ARPURLINFOABOUT" Value="NUnit is a testing framework for all .NET languages" />
    <Property Id="ARPURLUPDATEINFO" Value="http://nunit.org?p=download" />


    <!-- ***************************************************************** -->
    <!-- **********       Define Directory Structure            ********** -->
    <!-- ***************************************************************** -->

    <Directory Id="TARGETDIR" Name="SourceDir">

      <Directory Id='ProgramFilesFolder' Name='PFiles'>

        <!-- Target locations for NUnit Files -->
        <Directory Id='INSTALLDIR' Name='NUnit' LongName="NUnit $(var.NominalVersion)">

          <Directory Id='bin' Name='bin'>

            <Directory Id='lib' Name='lib' />
            <Directory Id='addins' Name='addins' />
            <Directory Id='tests' Name='tests' />
            <Directory Id='framework' Name='FRAMEWK' LongName='framework' />

          </Directory>

          <Directory Id='doc' Name='doc'>
            <Directory Id='files' Name='files' />
            <Directory Id='img' Name='img' />
          </Directory>

          <Directory Id='samples' Name='samples'>
            <Directory Id='csharp' Name='csharp' />
            <Directory Id='jsharp' Name='jsharp' />
            <Directory Id='vb' Name='vb' />
            <Directory Id='cpp' Name='cpp' />
            <Directory Id='extensibility' Name='EXTENSIB' LongName='Extensibility' />
          </Directory>

        </Directory>

      </Directory>

      <!-- Desktop Folder Directory for our Desktop Shortcut -->
      <Directory Id="DesktopFolder" Name="." SourceName="DESKTOP" LongSource="User's Desktop" />

      <!-- Program Menu Folder and our subfolders for Shortcuts -->
      <Directory Id="ProgramMenuFolder" Name="." SourceName="PROGRAMS" LongSource="User's Program Menu">
        <Directory Id="NUnitMenu" Name="NUnit" LongName="NUnit $(var.NominalVersion)" >
          <Directory Id="RunUnderMenu" Name="RunUnder" LongName="Select Runtime" />
          <Directory Id="SamplesMenu" Name="Samples" />
        </Directory>
      </Directory>

    </Directory>


    <!-- ***************************************************************** -->
    <!-- **********      Define the NUnit feature tree          ********** -->
    <!-- ***************************************************************** -->

    <!-- Base features are defined in base.wxs and base_x86.wxs -->
    <Feature Id="BaseFeature" ConfigurableDirectory="INSTALLDIR"
         Level="1" Title="NUnit $(var.NominalVersion)" Display='expand'
         Description="Installs the NUnit console runner and supporting assemblies required to write and run tests.">

      <!-- Defined in nunit-gui.wxs -->
      <Feature Id="GuiRunner" Level="1" Title='Gui Runner' Display='expand'
				         Description="Installs the NUnit GUI runner."/>

      <!-- Defined in pnunit.wxs -->
      <Feature Id="PNunitRunner" Level="10" Title='PNUnit Runner' Display='expand'
               Description="Installs the PNUnit runner for parallel distributed tests."/>

      <!-- Defined in tests.wxs and nunit-gui.wxs -->
      <Feature Id="TestsFeature" Level="10" Title='Unit Tests' Display='expand'
				         Description='Installs the unit tests for NUnit itself.'/>

      <!-- Defined in doc.wxs -->
      <Feature Id="DocumentationFeature" Level="1" Title='Documentation' Display='expand'
          Description="Installs the NUnit documentation."/>

      <!-- Defined in samples.wxs -->
      <Feature Id="SamplesFeature" Level="1" Title='Samples' Display='collapse'
               Description='Installs sample code showing the use of NUnit.' />

    </Feature>

    <!-- The NUnit files are all in a single cab file that is embedded in the MSI -->
    <Media Id="1" EmbedCab="yes" Cabinet="nunit.cab" />

    <!-- ***************************************************************** -->
    <!-- **********  Define our GUI using standard WiX UI       ********** -->
    <!-- ***************************************************************** -->

    <!--<UIRef Id="WixUI_Mondo" />-->
    <UIRef Id="WixUI_FeatureTree" />
    <UIRef Id="WixUI_ErrorProgressText" />

  </Product>
</Wix>